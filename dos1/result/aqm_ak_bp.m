function rtnvalue=aqm_ak_bp()
ak_n = [ 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 ];
ak_ap = [ 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 ];
ak_bp = [ 0.000000 20.000000 40.000000 60.000000 80.000000 100.000000 120.000000 140.000000 160.000000 180.000000 200.000000 220.000000 240.000000 260.000000 280.000000 300.000000 320.000000 340.000000 360.000000 380.000000 400.000000 420.000000 440.000000 460.000000 480.000000 500.000000 520.000000 540.000000 560.000000 580.000000 600.000000 ];
ak_pr = [ 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 ];
rate_f1_normal_droptail = [ 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 ];
rate_f1_attack_droptail = [ 670.100000 640.870000 630.870000 629.020000 630.550000 632.730000 601.350000 605.250000 568.960000 533.110000 562.200000 535.870000 476.960000 426.790000 435.310000 427.590000 398.550000 396.730000 393.580000 385.660000 394.010000 379.450000 350.610000 362.590000 359.710000 337.430000 311.900000 316.560000 301.250000 320.100000 306.620000 ];
nth_f1_droptail = [ 0.995943 0.952499 0.937637 0.934887 0.937161 0.940401 0.893762 0.899559 0.845622 0.792340 0.835575 0.796442 0.708886 0.634321 0.646984 0.635510 0.592349 0.589644 0.584962 0.573191 0.585601 0.563961 0.521097 0.538903 0.534622 0.501509 0.463564 0.470490 0.447736 0.475752 0.455717 ];
rate_f2_normal_droptail = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_droptail = [ 20.000000 260.000000 520.000000 760.000000 1020.000000 1260.000000 1520.000000 1760.000000 2020.000000 2260.000000 2520.000000 2760.000000 3020.000000 3260.000000 3520.000000 3760.000000 4020.000000 4260.000000 4520.000000 4760.000000 5020.000000 5260.000000 5520.000000 5760.000000 6020.000000 6260.000000 6520.000000 6760.000000 7020.000000 7260.000000 7520.000000 ];
nth_f2_droptail = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_red = [ 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 ];
rate_f1_attack_red = [ 669.530000 666.810000 646.170000 597.530000 560.000000 540.890000 510.420000 456.450000 413.760000 407.030000 394.520000 379.980000 367.070000 344.580000 331.420000 309.070000 304.950000 289.910000 292.650000 298.260000 302.390000 283.080000 280.460000 294.600000 281.360000 264.410000 265.140000 247.260000 222.370000 236.770000 218.880000 ];
nth_f1_red = [ 0.995140 0.991097 0.960419 0.888124 0.832342 0.803939 0.758650 0.678433 0.614982 0.604979 0.586385 0.564774 0.545586 0.512158 0.492598 0.459379 0.453255 0.430901 0.434973 0.443312 0.449450 0.420749 0.416855 0.437872 0.418193 0.392999 0.394084 0.367509 0.330514 0.351917 0.325327 ];
rate_f2_normal_red = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_red = [ 20.000000 260.000000 520.000000 760.000000 1020.000000 1260.000000 1520.000000 1760.000000 2020.000000 2260.000000 2520.000000 2760.000000 3020.000000 3260.000000 3520.000000 3760.000000 4020.000000 4260.000000 4520.000000 4760.000000 5020.000000 5260.000000 5520.000000 5760.000000 6020.000000 6260.000000 6520.000000 6760.000000 7020.000000 7260.000000 7520.000000 ];
nth_f2_red = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_redpd = [ 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 ];
rate_f1_attack_redpd = [ 692.320000 669.730000 607.590000 565.580000 496.150000 428.730000 419.960000 403.240000 298.280000 284.290000 256.920000 230.520000 254.800000 240.830000 200.880000 241.730000 231.950000 183.500000 208.000000 192.670000 176.740000 206.480000 163.120000 161.580000 175.140000 177.380000 149.510000 135.530000 137.730000 115.070000 112.830000 ];
nth_f1_redpd = [ 1.029013 0.995437 0.903077 0.840636 0.737441 0.637232 0.624197 0.599346 0.443341 0.422548 0.381867 0.342628 0.378716 0.357952 0.298573 0.359290 0.344753 0.272741 0.309156 0.286370 0.262693 0.306897 0.242449 0.240161 0.260315 0.263644 0.222221 0.201442 0.204712 0.171032 0.167702 ];
rate_f2_normal_redpd = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_redpd = [ 20.000000 260.000000 520.000000 760.000000 1020.000000 1260.000000 1520.000000 1760.000000 2020.000000 2260.000000 2520.000000 2760.000000 3020.000000 3260.000000 3520.000000 3760.000000 4020.000000 4260.000000 4520.000000 4760.000000 5020.000000 5260.000000 5520.000000 5760.000000 6020.000000 6260.000000 6520.000000 6760.000000 7020.000000 7260.000000 7520.000000 ];
nth_f2_redpd = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_sfb = [ 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 ];
rate_f1_attack_sfb = [ 653.780000 642.530000 570.380000 529.150000 509.380000 463.660000 409.040000 423.320000 372.120000 372.110000 354.820000 344.200000 342.760000 310.060000 329.130000 319.000000 335.850000 316.340000 308.050000 316.860000 305.630000 495.610000 463.490000 463.050000 450.840000 450.500000 585.620000 567.920000 572.020000 571.370000 579.270000 ];
nth_f1_sfb = [ 0.991207 0.974150 0.864762 0.802253 0.772279 0.702962 0.620152 0.641802 0.564177 0.564162 0.537948 0.521847 0.519664 0.470087 0.498999 0.483641 0.509188 0.479608 0.467040 0.480397 0.463371 0.751402 0.702705 0.702038 0.683526 0.683010 0.887868 0.861033 0.867249 0.866263 0.878241 ];
rate_f2_normal_sfb = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_sfb = [ 20.000000 260.000000 520.000000 760.000000 1020.000000 1260.000000 1520.000000 1760.000000 2020.000000 2260.000000 2520.000000 2760.000000 3020.000000 3260.000000 3520.000000 3760.000000 4020.000000 4260.000000 4520.000000 4760.000000 5020.000000 5260.000000 5520.000000 5760.000000 6020.000000 6260.000000 6520.000000 6760.000000 7020.000000 7260.000000 7520.000000 ];
nth_f2_sfb = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_avq = [ 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 ];
rate_f1_attack_avq = [ 656.900000 601.650000 581.430000 541.740000 511.030000 420.950000 359.980000 329.130000 323.860000 306.000000 299.230000 288.190000 281.390000 274.600000 254.170000 237.100000 223.680000 224.250000 196.830000 195.040000 187.210000 182.180000 170.410000 167.800000 158.290000 153.020000 143.840000 140.030000 132.240000 125.130000 123.060000 ];
nth_f1_avq = [ 0.996390 0.912586 0.881917 0.821715 0.775133 0.638500 0.546020 0.499226 0.491233 0.464143 0.453874 0.437128 0.426814 0.416515 0.385527 0.359635 0.339279 0.340144 0.298553 0.295838 0.283961 0.276332 0.258479 0.254520 0.240095 0.232102 0.218177 0.212398 0.200582 0.189798 0.186658 ];
rate_f2_normal_avq = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_avq = [ 20.000000 260.000000 520.000000 760.000000 1020.000000 1260.000000 1520.000000 1760.000000 2020.000000 2260.000000 2520.000000 2760.000000 3020.000000 3260.000000 3520.000000 3760.000000 4020.000000 4260.000000 4520.000000 4760.000000 5020.000000 5260.000000 5520.000000 5760.000000 6020.000000 6260.000000 6520.000000 6760.000000 7020.000000 7260.000000 7520.000000 ];
nth_f2_avq = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_rred = [ 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 ];
rate_f1_attack_rred = [ 641.890000 626.940000 620.640000 617.180000 606.420000 617.970000 608.410000 618.420000 611.430000 616.130000 619.360000 618.880000 613.200000 615.520000 617.310000 618.150000 617.970000 619.430000 618.380000 618.140000 619.370000 619.370000 619.370000 618.230000 613.730000 616.210000 619.590000 619.380000 616.800000 618.710000 618.600000 ];
nth_f1_rred = [ 0.986249 0.963278 0.953598 0.948282 0.931750 0.949496 0.934807 0.950187 0.939447 0.946669 0.951632 0.950894 0.942167 0.945732 0.948482 0.949773 0.949496 0.951739 0.950126 0.949757 0.951647 0.951647 0.951647 0.949896 0.942981 0.946792 0.951985 0.951662 0.947698 0.950633 0.950464 ];
rate_f2_normal_rred = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_rred = [ 20.000000 260.000000 520.000000 760.000000 1020.000000 1260.000000 1520.000000 1760.000000 2020.000000 2260.000000 2520.000000 2760.000000 3020.000000 3260.000000 3520.000000 3760.000000 4020.000000 4260.000000 4520.000000 4760.000000 5020.000000 5260.000000 5520.000000 5760.000000 6020.000000 6260.000000 6520.000000 6760.000000 7020.000000 7260.000000 7520.000000 ];
nth_f2_rred = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

figure;
hold on;
box on;
%ak_ap=ak_ap/1000;
x=strip(ak_bp);
rate_fix=8*1000/1024/1024;
plot(x, strip(rate_f1_attack_droptail)*rate_fix, '-ks','LineWidth',2);
plot(x, strip(rate_f1_attack_red)*rate_fix, '-M+','LineWidth',2);
plot(x, strip(rate_f1_attack_redpd)*rate_fix, '-Gv','LineWidth',2);
plot(x, strip(rate_f1_attack_avq)*rate_fix, '-c^','LineWidth',2);
plot(x, strip(rate_f1_attack_sfb)*rate_fix, '-bd','LineWidth',2);
plot(x, strip(rate_f1_attack_rred)*rate_fix, '-Ro','LineWidth',2);
legend ('DropTail','RED','RED-PD','AVQ','SFB','RRED','FontSize',14);
xlabel('Tb: LDoS attack burst width (ms)','FontSize',14);
ylabel('TCP throughput under attack (Mbps)','FontSize',14);
hold off;

rtnvalue=0;
end

function y=strip(x)
    for i=1:floor(size(x,2)/2)
        y(i)=x(i*2-1);
    end
    y(i+1)=x(size(x,2));
end
