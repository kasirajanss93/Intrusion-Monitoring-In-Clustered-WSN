function rtnvalue=aqm_ak_ap()
ak_n = [ 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 ];
ak_ap = [ 200.000000 300.000000 400.000000 500.000000 600.000000 700.000000 800.000000 900.000000 1000.000000 1100.000000 1200.000000 1300.000000 1400.000000 1500.000000 1600.000000 1700.000000 1800.000000 1900.000000 2000.000000 ];
ak_bp = [ 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 200.000000 ];
ak_pr = [ 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 0.250000 ];
rate_f1_normal_droptail = [ 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 672.830000 ];
rate_f1_attack_droptail = [ 178.430000 414.900000 391.330000 350.900000 629.580000 636.480000 633.590000 649.580000 562.200000 583.390000 601.530000 615.450000 627.120000 606.730000 609.270000 628.440000 625.720000 619.930000 607.770000 ];
nth_f1_droptail = [ 0.265193 0.616649 0.581618 0.521528 0.935719 0.945974 0.941679 0.965444 0.835575 0.867069 0.894030 0.914718 0.932063 0.901758 0.905533 0.934025 0.929982 0.921377 0.903304 ];
rate_f2_normal_droptail = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_droptail = [ 12601.000000 8405.200000 6300.000000 5040.000000 4208.400000 3603.600000 3150.000000 2810.800000 2520.000000 2293.200000 2116.800000 1940.400000 1814.400000 1688.400000 1587.600000 1486.800000 1411.200000 1335.600000 1260.000000 ];
nth_f2_droptail = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_red = [ 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 ];
rate_f1_attack_red = [ 118.940000 236.580000 345.720000 249.710000 420.560000 498.650000 518.880000 560.900000 394.520000 437.590000 537.830000 574.520000 600.810000 581.510000 546.250000 564.350000 572.730000 592.790000 595.840000 ];
nth_f1_red = [ 0.176784 0.351635 0.513853 0.371150 0.625089 0.741156 0.771225 0.833680 0.586385 0.650401 0.799391 0.853924 0.892999 0.864313 0.811905 0.838808 0.851263 0.881079 0.885612 ];
rate_f2_normal_red = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_red = [ 12601.000000 8405.200000 6300.000000 5040.000000 4208.400000 3603.600000 3150.000000 2810.800000 2520.000000 2293.200000 2116.800000 1940.400000 1814.400000 1688.400000 1587.600000 1486.800000 1411.200000 1335.600000 1260.000000 ];
nth_f2_red = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_redpd = [ 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 672.800000 ];
rate_f1_attack_redpd = [ 52.770000 138.700000 323.700000 145.060000 336.670000 450.170000 520.560000 507.880000 256.920000 382.150000 447.990000 554.420000 573.350000 497.650000 566.620000 593.360000 602.650000 617.470000 546.140000 ];
nth_f1_redpd = [ 0.078433 0.206153 0.481124 0.215606 0.500401 0.669099 0.773722 0.754875 0.381867 0.567999 0.665859 0.824049 0.852185 0.739670 0.842182 0.881926 0.895734 0.917762 0.811742 ];
rate_f2_normal_redpd = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_redpd = [ 12601.000000 8405.200000 6300.000000 5040.000000 4208.400000 3603.600000 3150.000000 2810.800000 2520.000000 2293.200000 2116.800000 1940.400000 1814.400000 1688.400000 1587.600000 1486.800000 1411.200000 1335.600000 1260.000000 ];
nth_f2_redpd = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_sfb = [ 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 659.580000 ];
rate_f1_attack_sfb = [ 599.500000 565.800000 545.040000 260.110000 468.340000 524.010000 590.180000 553.400000 354.820000 435.790000 523.100000 608.720000 636.520000 592.200000 588.380000 616.510000 621.990000 617.860000 596.700000 ];
nth_f1_sfb = [ 0.908912 0.857819 0.826344 0.394357 0.710058 0.794460 0.894782 0.839019 0.537948 0.660708 0.793080 0.922890 0.965038 0.897844 0.892053 0.934701 0.943009 0.936748 0.904667 ];
rate_f2_normal_sfb = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_sfb = [ 12601.000000 8405.200000 6300.000000 5040.000000 4208.400000 3603.600000 3150.000000 2810.800000 2520.000000 2293.200000 2116.800000 1940.400000 1814.400000 1688.400000 1587.600000 1486.800000 1411.200000 1335.600000 1260.000000 ];
nth_f2_sfb = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_avq = [ 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 659.280000 ];
rate_f1_attack_avq = [ 1.490000 236.510000 206.880000 250.290000 294.510000 475.530000 504.530000 486.220000 299.230000 232.260000 322.150000 443.870000 525.100000 457.670000 334.590000 437.130000 400.660000 417.640000 428.870000 ];
nth_f1_avq = [ 0.002260 0.358740 0.313797 0.379641 0.446715 0.721287 0.765274 0.737502 0.453874 0.352293 0.488639 0.673265 0.796475 0.694197 0.507508 0.663041 0.607724 0.633479 0.650513 ];
rate_f2_normal_avq = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_avq = [ 12601.000000 8405.200000 6300.000000 5040.000000 4208.400000 3603.600000 3150.000000 2810.800000 2520.000000 2293.200000 2116.800000 1940.400000 1814.400000 1688.400000 1587.600000 1486.800000 1411.200000 1335.600000 1260.000000 ];
nth_f2_avq = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

rate_f1_normal_rred = [ 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 650.840000 ];
rate_f1_attack_rred = [ 619.410000 611.170000 619.490000 608.810000 619.710000 625.620000 616.420000 621.870000 619.360000 629.570000 625.800000 631.080000 626.050000 625.510000 626.840000 629.220000 630.650000 624.820000 622.950000 ];
nth_f1_rred = [ 0.951709 0.939048 0.951831 0.935422 0.952170 0.961250 0.947114 0.955488 0.951632 0.967319 0.961527 0.969639 0.961911 0.961081 0.963125 0.966781 0.968979 0.960021 0.957148 ];
rate_f2_normal_rred = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ];
rate_f2_attack_rred = [ 12601.000000 8405.200000 6300.000000 5040.000000 4208.400000 3603.600000 3150.000000 2810.800000 2520.000000 2293.200000 2116.800000 1940.400000 1814.400000 1688.400000 1587.600000 1486.800000 1411.200000 1335.600000 1260.000000 ];
nth_f2_rred = [ -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 -1.000000 ];

figure;
hold on;
box on;
ak_ap=ak_ap/1000;
x=ak_ap;
rate_fix=8*1000/1024/1024;
plot(x, rate_f1_attack_droptail*rate_fix, '-ks','LineWidth',2);
plot(x, rate_f1_attack_red*rate_fix, '-M+','LineWidth',2);
plot(x, rate_f1_attack_redpd*rate_fix, '-Gv','LineWidth',2);
plot(x, rate_f1_attack_avq*rate_fix, '-c^','LineWidth',2);
plot(x, rate_f1_attack_sfb*rate_fix, '-bd','LineWidth',2);
plot(x, rate_f1_attack_rred*rate_fix, '-Ro','LineWidth',2);
legend ('DropTail','RED','RED-PD','AVQ','SFB','RRED','FontSize',14);
xlabel('Ta: LDoS attack period (s)','FontSize',14);
ylabel('TCP throughput under attack (Mbps)','FontSize',14);
hold off;

rtnvalue=0;